<Quests> <Quest Name="promo_RealMoneyItemRegister" Priority="0"> <Events> <Purchase /> </Events> <Conditions> <Operator Type="Or"> <Equal Value1="?Item(_$Purchase).SubType" Value2="Gold" /> <Equal Value1="?Item(_$Purchase).SubType" Value2="Bonus" /> </Operator> </Conditions> <Actions> <SetVariable Name="LastRealPurchaseTime" Value="?SysInfo().Time" /> <SetVariable Name="LastRealPurchase" Value="?Purchase(_$Purchase).Name" /> </Actions> </Quest> <Quest Name="StarterPackLaunch"> <Events> <FightEnd /> </Events> <Conditions> <Equal Value1="_$Fight" Value2="ZONE_1|Tournament|5" /> <Equal Value1="_$FightResult" Value2="Win" /> <GreaterEqual Not="1" Value1="?Item(WEAPON_STARTER_PACK_TONFA).Quantity" Value2="1" /> <GreaterEqual Not="1" Value1="?Item(HELM_STARTER_PACK).Quantity" Value2="1" /> <Greater Not="1" Value1="?Timer(Timer_RepeatPayment).Value" Value2="0" /> <Greater Not="1" Value1="?Timer(Timer_IncreasePayment).Value" Value2="0" /> </Conditions> <Actions Place="Map"> <ActivateTimer Name="Timer_StarterPack" Value="1800" /> <ShowMapButton Name="Button_StarterPack" Image="starter_pack" Timer="Timer_StarterPack" /> <Activate ActionID="StarterPackDialog" /> </Actions> </Quest> <Quest Name="StarterPackPress"> <Events> <MapButtonPress /> </Events> <Conditions> <Equal Value1="_$ButtonName" Value2="Button_StarterPack" /> </Conditions> <Actions> <Activate ActionID="StarterPackDialog" /> </Actions> </Quest> <Quest Name="StarterPackDialog" Unresumable="1"> <Events> <Activate /> </Events> <Conditions> <Equal Value1="_$ActionID" Value2="StarterPackDialog" /> <Greater Not="1" Value1="_DiscipleFlag" Value2="0" /> <Equal Not="1" Value1="?Item(HELM_STARTER_PACK).Quantity" Value2="1" /> </Conditions> <Actions Place="Map"> <Dialog Type="Multiline" Title="dlgStarterPackTitle" Image="starter_pack"> <Line Text="dlgStarterPackOffer1{textures/misc/tick_red.png}"/> <Line Text="dlgStarterPackOffer2{textures/misc/tick_red.png}{textures/misc/ruby.png}{30}"/> <Line Text="dlgStarterPackOffer3{textures/misc/tick_red.png}{textures/misc/gold.png}{1000}"/> <Line Text="dlgStarterPackOffer4{textures/misc/tick_red.png}"/> <Line Text="dlgStarterPackOffer5{textures/misc/tick_red.png}"/> <PriceLine Text="dlgStarterPackPrice{?Item(Pack_Starter).RealPrice}" TextColor="0xfefe95" /> <Button Type="Right" Color="Green" Text="dlgBuyButton"> <BuyItem Name="Pack_Starter" Currency="Real" /> </Button> <Button Type="Left" Color="Red" Text="dlgLaterBtn" > <ClearQuestQueue Name="StarterPackDialog" /> <Dialog Type="Multiline" Title="dlgStarterPackTitle" Image="starter_pack"> <Line Text="dlgStarterPackRefusal"> <Timer Name="Timer_StarterPack" /> </Line> <Button Type="Right" Color="Beige" Text="dlgStoryBtnOk" /> </Dialog> </Button> </Dialog> </Actions> </Quest> <Quest Name="StarterPackDialogNoSurprise" Unresumable="1"> <Events> <Activate /> </Events> <Conditions> <Equal Value1="_$ActionID" Value2="StarterPackDialog" /> <Greater Value1="_DiscipleFlag" Value2="0" /> <Equal Not="1" Value1="?Item(HELM_STARTER_PACK).Quantity" Value2="1" /> </Conditions> <Actions Place="Map"> <Dialog Type="Multiline" Title="dlgStarterPackTitle" Image="starter_pack"> <Line Text="dlgStarterPackOffer1{textures/misc/tick_red.png}"/> <Line Text="dlgStarterPackOffer2{textures/misc/tick_red.png}{textures/misc/ruby.png}{30}"/> <Line Text="dlgStarterPackOffer3{textures/misc/tick_red.png}{textures/misc/gold.png}{1000}"/> <PriceLine Text="dlgStarterPackPrice{?Item(Pack_Starter).RealPrice}" TextColor="0xfefe95" /> <Button Type="Right" Color="Green" Text="dlgBuyButton"> <BuyItem Name="Pack_Starter" Currency="Real" /> </Button> <Button Type="Left" Color="Red" Text="dlgLaterBtn" > <ClearQuestQueue Name="StarterPackDialog" /> <Dialog Type="Multiline" Title="dlgStarterPackTitle" Image="starter_pack"> <Line Text="dlgStarterPackRefusal"> <Timer Name="Timer_StarterPack" /> </Line> <Button Type="Right" Color="Beige" Text="dlgStoryBtnOk" /> </Dialog> </Button> </Dialog> </Actions> </Quest> <Quest Name="StarterPackBought"> <Events> <Purchase /> </Events> <Conditions> <Equal Value1="?Purchase(_$Purchase).Name" Value2="Pack_Starter" /> <Equal Value1="_FirstSuperItemFlag" Value2="1" /> </Conditions> <Actions> <GiveItem Name="?Concat(WEAPON_STARTER_PACK_TONFA|,?Sum(?Multi(100,?Player().Level),30))" PutOn="1" Quantity="1" /> <SetVariable Name="BestAcquiredWeaponLevel" Value="?Purchase(WEAPON_STARTER_PACK_TONFA).UpgradeLevel" /> <SetVariable Name="StarterPackOfferEnded" Value="1" /> <EndTimer Name="Timer_StarterPack"/> <HideMapButton Name="Button_StarterPack"/> <OpenShop Tab="Weapon" Item="WEAPON_STARTER_PACK_TONFA"/> </Actions> </Quest> <Quest Name="StarterPackBoughtFirstSuperItem"> <Events> <Purchase /> </Events> <Conditions> <Equal Value1="?Purchase(_$Purchase).Name" Value2="Pack_Starter" /> <Equal Not="1" Value1="_FirstSuperItemFlag" Value2="1" /> </Conditions> <Actions> <GiveItem Name="?Concat(WEAPON_STARTER_PACK_TONFA|,?Sum(?Multi(100,?Player().Level),30))" PutOn="1" Quantity="1" /> <SetVariable Name="BestAcquiredWeaponLevel" Value="?Purchase(WEAPON_STARTER_PACK_TONFA).UpgradeLevel" /> <SetVariable Name="StarterPackOfferEnded" Value="1" /> <EndTimer Name="Timer_StarterPack"/> <HideMapButton Name="Button_StarterPack"/> <OpenShop Tab="Weapon" Item="WEAPON_STARTER_PACK_TONFA"/> <Dialog Type="Regular" Title="characterMay" Image="character_may_3"> <Line Text="dlgSuperItemAvailable"/> <Button Type="Right" Color="Green" Text="dlgStoryBtnOk" /> </Dialog> <SetVariable Name="FirstSuperItemFlag" Value="1" /> <ClearQuestQueue Name="FirstSuperItemAvailable" /> </Actions> </Quest> <Quest Name="StarterPackDismiss"> <Events> <TimerEnd /> </Events> <Conditions> <Equal Value1="_$TimerName" Value2="Timer_StarterPack" /> </Conditions> <Actions> <EndTimer Name="Timer_StarterPack"/> <HideMapButton Name="Button_StarterPack"/> <SetVariable Name="StarterPackOfferEnded" Value="1" /> </Actions> </Quest> <Quest Name="StarterPackOnRestart" Priority="10" Unresumable="1"> <Events> <Activate /> </Events> <Conditions> <Equal Value1="_$ActionID" Value2="PseudoSessionStart" /> <Greater Value1="?Timer(Timer_StarterPack).Value" Value2="0" /> </Conditions> <Actions> <Activate ActionID="StarterPackDialog" /> </Actions> </Quest> <Quest Name="promo_FirstPayment_ZoneSwitch"> <Events> <FightEnd /> </Events> <Conditions> <Equal Value1="_$FightResult" Value2="Win" /> <Operator Type="Or"> <Equal Value1="_$Fight" Value2="ZONE_1|BOSS_LYNX|6" /> <Equal Value1="_$Fight" Value2="ZONE_2|BOSS_HERMIT|6" /> <Equal Value1="_$Fight" Value2="ZONE_3|BOSS_BUTCHER|6" /> <Equal Value1="_$Fight" Value2="ZONE_4|BOSS_WASP|6" /> <Equal Value1="_$Fight" Value2="ZONE_5|BOSS_HUNTRESS|6" /> <Equal Value1="_$Fight" Value2="ZONE_6|FINAL_BATTLE|1" /> <Equal Value1="_$Fight" Value2="ZONE_1|BOSS_LYNX_INTERMISSION|1" /> <Equal Value1="_$Fight" Value2="ZONE_2|BOSS_HERMIT_INTERMISSION|1" /> <Equal Value1="_$Fight" Value2="ZONE_3|BOSS_BUTCHER_INTERMISSION|1" /> <Equal Value1="_$Fight" Value2="ZONE_4|BOSS_WASP_INTERMISSION|1" /> <Equal Value1="_$Fight" Value2="ZONE_5|BOSS_HUNTRESS_INTERMISSION|1" /> </Operator> <Greater Value1="?Timer(Timer_FirstPayment).Value" Value2="0" /> </Conditions> <Actions> <Discount Item="_promo_FirstPayment_Item" Toggle="0" /> <Foreach Type="PaidItems" Name="FindCoinPileItem" /> <HideMapButton Name="Button_FirstPayment"/> <ShowMapButton Name="Button_FirstPayment" Image="?Item(_promo_FirstPayment_Item).Image" Timer="Timer_FirstPayment" /> <Discount Item="_promo_FirstPayment_Item" NewAmount="?Multi(_promo_Multiplier,?Item(_promo_FirstPayment_Item).RecieveGold)" Period="?Timer(Timer_FirstPayment).Value" Toggle="1" /> </Actions> </Quest> <Quest Name="FindCoinPileItem"> <Conditions> <Equal Value1="?Item(_$Iterator).SubType" Value2="Gold" /> <Equal Value1="?Slice(_$Iterator,0,3)" Value2="Pile" /> <Equal Value1="?Item(_$Iterator).Availability" Value2="1" /> </Conditions> <Actions> <SetVariable Name="promo_FirstPayment_Item" Value="_$Iterator" /> </Actions> </Quest> <Quest Name="promo_FirstPayment_OnFightEnter" Priority="10" Group="FightEnter" Unresumable="1"> <Events> <FightEnter /> </Events> <Conditions> <Equal Value1="?Fight(_$Fight).Battle" Value2="Survival" /> <GreaterEqual Value1="_SurvivalsInARowCount" Value2="3" /> <Operator Type="Or"> <Equal Value1="_StarterPackOfferEnded" Value2="1" /> <Less Value1="?Fight(ZONE_1|BOSS_LYNX|6).WinCount" Value2="1" Not="1" /> </Operator> <Greater Not="1" Value1="?Timer(Timer_FirstPayment).Value" Value2="0" /> <Greater Not="1" Value1="_DiscipleFlag" Value2="0" /> </Conditions> <Actions> <Foreach Type="PaidItems" Name="FindCoinPileItem" /> <ClearQuestQueue Name="SurvivalPayReminder" /> <ActivateTimer Name="Timer_FirstPayment" Value="1800" /> <ShowMapButton Name="Button_FirstPayment" Image="?Item(_promo_FirstPayment_Item).Image" Timer="Timer_FirstPayment" /> <Discount Item="_promo_FirstPayment_Item" NewAmount="?Multi(_promo_Multiplier,?Item(_promo_FirstPayment_Item).RecieveGold)" Period="?Timer(Timer_FirstPayment).Value" Toggle="1" /> <Dialog Type="Multiline" Title="dlgSpecialOfferTitle" Image="?Item(_promo_FirstPayment_Item).Image"> <Line Text="dlgFirstPaymentOffer{?Concat(%,_promo_FirstPayment_Item}"/> <PriceLine Text="dlgProfitablePrice{?Concat(textures/misc/,?Player().CoinIcon)}{?Multi(_promo_Multiplier,?Item(_promo_FirstPayment_Item).RecieveGold)}{?Item(_promo_FirstPayment_Item).RealPrice}" TextColor="0xfefe95" /> <Button Type="Right" Color="Green" Text="dlgBuyButton"> <BuyItem Name="_promo_FirstPayment_Item" Currency="Real" /> </Button> <Button Type="Left" Color="Red" Text="dlgLaterBtn" > <Dialog Type="Multiline" Title="dlgSpecialOfferTitle" Image="?Item(_promo_FirstPayment_Item).Image"> <Line Text="dlgFirstPaymentRefusal"> <Timer Name="Timer_FirstPayment" /> </Line> <Button Type="Right" Color="Beige" Text="dlgStoryBtnOk" /> </Dialog> <Fight Name="_$Fight" /> </Button> </Dialog> </Actions> </Quest> <Quest Name="promo_FirstPayment_OnPress" Unresumable="1"> <Events> <MapButtonPress /> </Events> <Conditions> <Equal Value1="_$ButtonName" Value2="Button_FirstPayment" /> </Conditions> <Actions> <Dialog Type="Multiline" Title="dlgSpecialOfferTitle" Image="?Item(_promo_FirstPayment_Item).Image"> <Line Text="dlgFirstPaymentOffer{?Concat(%,_promo_FirstPayment_Item}"/> <PriceLine Text="dlgProfitablePrice{?Concat(textures/misc/,?Player().CoinIcon)}{?Multi(_promo_Multiplier,?Item(_promo_FirstPayment_Item).RecieveGold)}{?Item(_promo_FirstPayment_Item).RealPrice}" TextColor="0xfefe95" /> <Button Type="Right" Color="Green" Text="dlgBuyButton"> <BuyItem Name="_promo_FirstPayment_Item" Currency="Real" /> </Button> <Button Type="Left" Color="Red" Text="dlgLaterBtn" > <Dialog Type="Multiline" Title="dlgSpecialOfferTitle" Image="?Item(_promo_FirstPayment_Item).Image"> <Line Text="dlgFirstPaymentRefusal"> <Timer Name="Timer_FirstPayment" /> </Line> <Button Type="Right" Color="Beige" Text="dlgStoryBtnOk" /> </Dialog> </Button> </Dialog> </Actions> </Quest> <Quest Name="promo_FirstPayment_OnRestart" Priority="10" Unresumable="1"> <Events> <Activate /> </Events> <Conditions> <Equal Value1="_$ActionID" Value2="PseudoSessionStart" /> <Greater Value1="?Timer(Timer_FirstPayment).Value" Value2="0" /> </Conditions> <Actions> <Discount Item="_promo_FirstPayment_Item" NewAmount="?Multi(_promo_Multiplier,?Item(_promo_FirstPayment_Item).RecieveGold)" Period="?Timer(Timer_FirstPayment).Value" Toggle="1" /> <Dialog Type="Multiline" Title="dlgSpecialOfferTitle" Image="?Item(_promo_FirstPayment_Item).Image"> <Line Text="dlgFirstPaymentOffer{?Concat(%,_promo_FirstPayment_Item}"/> <PriceLine Text="dlgProfitablePrice{?Concat(textures/misc/,?Player().CoinIcon)}{?Multi(_promo_Multiplier,?Item(_promo_FirstPayment_Item).RecieveGold)}{?Item(_promo_FirstPayment_Item).RealPrice}" TextColor="0xfefe95" /> <Button Type="Right" Color="Green" Text="dlgBuyButton"> <BuyItem Name="_promo_FirstPayment_Item" Currency="Real" /> </Button> <Button Type="Left" Color="Red" Text="dlgLaterBtn" > <Dialog Type="Multiline" Title="dlgSpecialOfferTitle" Image="?Item(_promo_FirstPayment_Item).Image"> <Line Text="dlgFirstPaymentRefusal"> <Timer Name="Timer_FirstPayment" /> </Line> <Button Type="Right" Color="Beige" Text="dlgStoryBtnOk" /> </Dialog> </Button> </Dialog> </Actions> </Quest> <Quest Name="promo_FirstPayment_Bought" Priority="5"> <Events> <Purchase /> </Events> <Conditions> <Greater Value1="?Timer(Timer_FirstPayment).Value" Value2="0" /> <Operator Type="Or"> <Equal Value1="?Item(_$Purchase).SubType" Value2="Gold" /> <Equal Value1="?Item(_$Purchase).SubType" Value2="Bonus" /> </Operator> </Conditions> <Actions> <Discount Item="_promo_FirstPayment_Item" Toggle="0" /> <EndTimer Name="Timer_FirstPayment"/> <HideMapButton Name="Button_FirstPayment"/> </Actions> </Quest> <Quest Name="promo_FirstPayment_Dismiss"> <Events> <TimerEnd /> </Events> <Conditions> <Equal Value1="_$TimerName" Value2="Timer_FirstPayment" /> </Conditions> <Actions> <HideMapButton Name="Button_FirstPayment"/> </Actions> </Quest> <Quest Name="FindRepeatPaymentGoldItem"> <Conditions> <Equal Value1="?Item(_$Iterator).SubType" Value2="Gold" /> <Equal Value1="?Slice(_$Iterator,0,5)" Value2="?Slice(_LastRealPurchase,0,5)" /> <Equal Value1="?Item(_$Iterator).Availability" Value2="1" /> </Conditions> <Actions> <SetVariable Name="LastRealPurchase" Value="_$Iterator" /> </Actions> </Quest> <Quest Name="promo_RepeatPayment_SessionStart_Gold" Priority="10" Unresumable="1"> <Events> <Activate /> </Events> <Conditions> <Operator Type="Or"> <Operator Type="And"> <Equal Value1="_$ActionID" Value2="PseudoSessionStart" /> <Greater Not="1" Value1="?Timer(Timer_RepeatPayment).Value" Value2="0" /> </Operator> <Operator Type="And"> <Equal Value1="_$ActionID" Value2="Intermission_Denomination" /> <Greater Value1="?Timer(Timer_RepeatPayment).Value" Value2="0" /> </Operator> </Operator> <Greater Value1="_DiscipleFlag" Value2="0" /> <GreaterEqual Value1="?Sub(?SysInfo().Time,_LastRealPurchaseTime)" Value2="345600" /> <Greater Not="1" Value1="?Timer(Timer_FirstPayment).Value" Value2="0" /> <Greater Not="1" Value1="?Timer(Timer_StarterPack).Value" Value2="0" /> <Greater Not="1" Value1="?Timer(Timer_IncreasePayment).Value" Value2="0" /><Equal Value1="?Item(_LastRealPurchase).SubType" Value2="Gold" /> </Conditions> <Actions> <Foreach Type="PaidItems" Name="FindRepeatPaymentGoldItem" /> <ActivateTimer Name="Timer_RepeatPayment" Value="1800" /> <ShowMapButton Name="Button_RepeatPayment" Image="?Item(_LastRealPurchase).Image" Timer="Timer_RepeatPayment" /> <Discount Item="_LastRealPurchase" NewAmount="?Multi(_promo_Multiplier,?Item(_LastRealPurchase).RecieveGold)" Period="?Timer(Timer_RepeatPayment).Value" Toggle="1" /> <Activate ActionID="RepeatPaymentDialog" /> </Actions> </Quest> <Quest Name="promo_RepeatPayment_SessionStart_Ruby" Priority="10" Unresumable="1"> <Events> <Activate /> </Events> <Conditions> <Operator Type="Or"> <Operator Type="And"> <Equal Value1="_$ActionID" Value2="PseudoSessionStart" /> <Greater Not="1" Value1="?Timer(Timer_RepeatPayment).Value" Value2="0" /> </Operator> <Operator Type="And"> <Equal Value1="_$ActionID" Value2="Intermission_Denomination" /> <Greater Value1="?Timer(Timer_RepeatPayment).Value" Value2="0" /> </Operator> </Operator> <Greater Value1="_DiscipleFlag" Value2="0" /> <GreaterEqual Value1="?Sub(?SysInfo().Time,_LastRealPurchaseTime)" Value2="345600" /> <Greater Not="1" Value1="?Timer(Timer_FirstPayment).Value" Value2="0" /> <Greater Not="1" Value1="?Timer(Timer_StarterPack).Value" Value2="0" /> <Greater Not="1" Value1="?Timer(Timer_IncreasePayment).Value" Value2="0" /> <Equal Value1="?Item(_LastRealPurchase).SubType" Value2="Bonus" /> </Conditions> <Actions> <ActivateTimer Name="Timer_RepeatPayment" Value="1800" /> <ShowMapButton Name="Button_RepeatPayment" Image="?Item(_LastRealPurchase).Image" Timer="Timer_RepeatPayment" /> <Discount Item="_LastRealPurchase" NewAmount="?Multi(_promo_Multiplier,?Item(_LastRealPurchase).RecieveBonus)" Period="?Timer(Timer_RepeatPayment).Value" Toggle="1" /> <Activate ActionID="RepeatPaymentDialog" /> </Actions> </Quest> <Quest Name="promo_RepeatPayment_Press" Unresumable="1"> <Events> <MapButtonPress /> </Events> <Conditions> <Equal Value1="_$ButtonName" Value2="Button_RepeatPayment" /> </Conditions> <Actions> <Activate ActionID="RepeatPaymentDialog" /> </Actions> </Quest> <Quest Name="promo_RepeatPayment_OnRestart" Priority="10" Unresumable="1"> <Events> <Activate /> </Events> <Conditions> <Equal Value1="_$ActionID" Value2="PseudoSessionStart" /> <Greater Value1="?Timer(Timer_RepeatPayment).Value" Value2="0" /> </Conditions> <Actions> <Activate ActionID="RepeatPaymentDialog" /> </Actions> </Quest> <Quest Name="RepeatPaymentDialogGold" Unresumable="1"> <Events> <Activate /> </Events> <Conditions> <Equal Value1="_$ActionID" Value2="RepeatPaymentDialog" /> <Equal Value1="?Item(_LastRealPurchase).SubType" Value2="Gold" /> </Conditions> <Actions> <Discount Item="_LastRealPurchase" NewAmount="?Multi(_promo_Multiplier,?Item(_LastRealPurchase).RecieveGold)" Period="?Timer(Timer_RepeatPayment).Value" Toggle="1" /> <Dialog Type="Multiline" Title="dlgSpecialOfferTitle" Image="?Item(_LastRealPurchase).Image"> <Line Text="dlgRepeatPaymentOffer_Gold{?Concat(%,_LastRealPurchase)}"> <Timer Name="Timer_RepeatPayment" /> </Line> <PriceLine Text="dlgProfitablePrice{?Concat(textures/misc/,?Player().CoinIcon)}{?Multi(_promo_Multiplier,?Item(_LastRealPurchase).RecieveGold)}{?Item(_LastRealPurchase).RealPrice}" TextColor="0xfefe95" /> <Button Type="Right" Color="Green" Text="dlgBuyButton"> <BuyItem Name="_LastRealPurchase" Currency="Real" /> </Button> <Button Type="Left" Color="Red" Text="dlgLaterBtn" /> </Dialog> </Actions> </Quest> <Quest Name="RepeatPaymentDialogRuby" Unresumable="1"> <Events> <Activate /> </Events> <Conditions> <Equal Value1="_$ActionID" Value2="RepeatPaymentDialog" /> <Equal Value1="?Item(_LastRealPurchase).SubType" Value2="Bonus" /> </Conditions> <Actions> <Discount Item="_LastRealPurchase" NewAmount="?Multi(_promo_Multiplier,?Item(_LastRealPurchase).RecieveBonus)" Period="?Timer(Timer_RepeatPayment).Value" Toggle="1" /> <Dialog Type="Multiline" Title="dlgSpecialOfferTitle" Image="?Item(_LastRealPurchase).Image"> <Line Text="dlgRepeatPaymentOffer_Ruby{?Concat(%,_LastRealPurchase)}"> <Timer Name="Timer_RepeatPayment" /> </Line> <PriceLine Text="dlgProfitablePrice{?Concat(textures/misc/ruby.png)}{?Multi(_promo_Multiplier,?Item(_LastRealPurchase).RecieveBonus)}{?Item(_LastRealPurchase).RealPrice}" TextColor="0xfefe95" /> <Button Type="Right" Color="Green" Text="dlgBuyButton"> <BuyItem Name="_LastRealPurchase" Currency="Real" /> </Button> <Button Type="Left" Color="Red" Text="dlgLaterBtn" /> </Dialog> </Actions> </Quest> <Quest Name="promo_RepeatPayment_Bought" Priority="5"> <Events> <Purchase /> </Events> <Conditions> <Greater Value1="?Timer(Timer_RepeatPayment).Value" Value2="0" /> <Operator Type="Or"> <Equal Value1="?Item(_$Purchase).SubType" Value2="Gold" /> <Equal Value1="?Item(_$Purchase).SubType" Value2="Bonus" /> </Operator> </Conditions> <Actions> <Discount Item="_LastRealPurchase" Toggle="0" /> <EndTimer Name="Timer_RepeatPayment"/> <HideMapButton Name="Button_RepeatPayment"/> </Actions> </Quest> <Quest Name="promo_RepeatPayment_Dismiss"> <Events> <TimerEnd /> </Events> <Conditions> <Equal Value1="_$TimerName" Value2="Timer_RepeatPayment" /> </Conditions> <Actions> <Discount Item="_LastRealPurchase" Toggle="0" /> <HideMapButton Name="Button_RepeatPayment"/> </Actions> </Quest> <Quest Name="promo_IncreasePayment_OnPurchase"> <Events> <PrePurchase /> </Events> <Conditions> <GreaterEqual Value1="?Fight(ZONE_1|Tournament|5).WinCount" Value2="1" /> <Greater Value1="?UniformIntRandom(1,100)" Value2="50" /> <Greater Value1="_DiscipleFlag" Value2="0" /> <Greater Not="1" Value1="?Timer(Timer_RepeatPayment).Value" Value2="0" /> <Greater Not="1" Value1="?Timer(Timer_StarterPack).Value" Value2="0" /> <Greater Not="1" Value1="?Timer(Timer_FirstPayment).Value" Value2="0" /> <Greater Not="1" Value1="?Timer(Timer_IncreasePayment).Value" Value2="0" /> <Operator Type="And"> <Operator Type="Or"> <Operator Type="And"> <Equal Value1="_$Purchase" Value2="Pile_Gems" /> <Equal Value1="_Show_Promo_Pile_Gems" Value2="1" /> </Operator> <Operator Type="And"> <Equal Value1="_$Purchase" Value2="Casket_Gems" /> <Equal Value1="_Show_Promo_Casket_Gems" Value2="1" /> </Operator> <Operator Type="And"> <Equal Value1="_$Purchase" Value2="Bag_Gems" /> <Equal Value1="_Show_Promo_Bag_Gems" Value2="1" /> </Operator> <Operator Type="And"> <Equal Value1="_$Purchase" Value2="Chest_Gems" /> <Equal Value1="_Show_Promo_Chest_Gems" Value2="1" /> </Operator> <Operator Type="And"> <Equal Value1="?Slice(_$Purchase,0,9)" Value2="Pile_Coins" /> <Equal Value1="_Show_Promo_Pile_Coins" Value2="1" /> </Operator> <Operator Type="And"> <Equal Value1="?Slice(_$Purchase,0,8)" Value2="Bag_Coins" /> <Equal Value1="_Show_Promo_Bag_Coins" Value2="1" /> </Operator> </Operator> <Operator Type="Or"> <Operator Type="And"> <Equal Value1="?Item(_$Purchase).SubType" Value2="Bonus" /> <Equal Not="1" Value1="_promo_IncreasePayment_Item_Bonus" Value2="Greater" /> </Operator> <Operator Type="And"> <Equal Not="1" Value1="?Slice(_promo_IncreasePayment_Item_Gold,0,12)" Value2="Greater_Coins" /> <Equal Value1="?Item(_$Purchase).SubType" Value2="Gold" /> </Operator> </Operator> </Operator> </Conditions> <Actions> <SetVariable Name="promo_PrePurchase" Value="_$Purchase" /> <Activate ActionID="IncreasePayment_Launch" /> </Actions> </Quest> <Quest Name="Unlock_Promo_Pile_Gems" Unresumable="1"> <Events> <Purchase /> </Events> <Conditions> <Equal Value1="_$Purchase" Value2="Pile_Gems" /> <Equal Not="1" Value1="_Show_Promo_Pile_Gems" Value2="1" /> </Conditions> <Actions> <SetVariable Name="Show_Promo_Pile_Gems" Value="1" /> </Actions> </Quest> <Quest Name="Unlock_Promo_Casket_Gems" Unresumable="1"> <Events> <Purchase /> </Events> <Conditions> <Equal Value1="_$Purchase" Value2="Casket_Gems" /> <Equal Not="1" Value1="_Show_Promo_Casket_Gems" Value2="1" /> </Conditions> <Actions> <SetVariable Name="Show_Promo_Casket_Gems" Value="1" /> </Actions> </Quest> <Quest Name="Unlock_Promo_Bag_Gems" Unresumable="1"> <Events> <Purchase /> </Events> <Conditions> <Equal Value1="_$Purchase" Value2="Bag_Gems" /> <Equal Not="1" Value1="_Show_Promo_Bag_Gems" Value2="1" /> </Conditions> <Actions> <SetVariable Name="Show_Promo_Bag_Gems" Value="1" /> </Actions> </Quest> <Quest Name="Unlock_Promo_Chest_Gems" Unresumable="1"> <Events> <Purchase /> </Events> <Conditions> <Equal Value1="_$Purchase" Value2="Chest_Gems" /> <Equal Not="1" Value1="_Show_Promo_Chest_Gems" Value2="1" /> </Conditions> <Actions> <SetVariable Name="Show_Promo_Chest_Gems" Value="1" /> </Actions> </Quest> <Quest Name="Unlock_Promo_Pile_Coins" Unresumable="1"> <Events> <Purchase /> </Events> <Conditions> <Equal Value1="?Slice(_$Purchase,0,9)" Value2="Pile_Coins" /> <Equal Not="1" Value1="_Show_Promo_Pile_Coins" Value2="1" /> </Conditions> <Actions> <SetVariable Name="Show_Promo_Pile_Coins" Value="1" /> </Actions> </Quest> <Quest Name="Unlock_Promo_Bag_Coins" Unresumable="1"> <Events> <Purchase /> </Events> <Conditions> <Equal Value1="?Slice(_$Purchase,0,8)" Value2="Bag_Coins" /> <Equal Not="1" Value1="_Show_Promo_Bag_Coins" Value2="1" /> </Conditions> <Actions> <SetVariable Name="Show_Promo_Bag_Coins" Value="1" /> </Actions> </Quest> <Quest Name="FindNextGradePaidItem_Pile_Gems" Unresumable="1"> <Events> <Purchase /> </Events> <Conditions> <Equal Value1="_$Purchase" Value2="Pile_Gems" /> <Equal Not="1" Value1="_promo_IncreasePayment_Item_Bonus" Value2="Casket_Gems" /> <Equal Not="1" Value1="_promo_IncreasePayment_Item_Bonus" Value2="Bag_Gems" /> <Equal Not="1" Value1="_promo_IncreasePayment_Item_Bonus" Value2="Chest_Gems" /> <Equal Not="1" Value1="_promo_IncreasePayment_Item_Bonus" Value2="Greater" /> </Conditions> <Actions> <SetVariable Name="promo_IncreasePayment_Item_Bonus" Value="Casket_Gems" /> </Actions> </Quest> <Quest Name="FindNextGradePaidItem_Casket_Gems" Unresumable="1"> <Events> <Purchase /> </Events> <Conditions> <Equal Value1="_$Purchase" Value2="Casket_Gems" /> <Equal Not="1" Value1="_promo_IncreasePayment_Item_Bonus" Value2="Bag_Gems" /> <Equal Not="1" Value1="_promo_IncreasePayment_Item_Bonus" Value2="Chest_Gems" /> <Equal Not="1" Value1="_promo_IncreasePayment_Item_Bonus" Value2="Greater" /> </Conditions> <Actions> <SetVariable Name="promo_IncreasePayment_Item_Bonus" Value="Bag_Gems" /> </Actions> </Quest> <Quest Name="FindNextGradePaidItem_Bag_Gems" Unresumable="1"> <Events> <Purchase /> </Events> <Conditions> <Equal Value1="_$Purchase" Value2="Bag_Gems" /> <Equal Not="1" Value1="_promo_IncreasePayment_Item_Bonus" Value2="Chest_Gems" /> <Equal Not="1" Value1="_promo_IncreasePayment_Item_Bonus" Value2="Greater" /> </Conditions> <Actions> <SetVariable Name="promo_IncreasePayment_Item_Bonus" Value="Chest_Gems" /> </Actions> </Quest> <Quest Name="FindNextGradePaidItem_Chest_Gems" Unresumable="1"> <Events> <Purchase /> </Events> <Conditions> <Equal Value1="_$Purchase" Value2="Chest_Gems" /> <Equal Not="1" Value1="_promo_IncreasePayment_Item_Bonus" Value2="Greater" /> </Conditions> <Actions> <SetVariable Name="promo_IncreasePayment_Item_Bonus" Value="Greater" /> </Actions> </Quest> <Quest Name="FindNextGradePaidItem_Pile_Coins" Unresumable="1"> <Events> <Purchase /> </Events> <Conditions> <Equal Value1="?Slice(_$Purchase,0,9)" Value2="Pile_Coins" /> <Equal Not="1" Value1="?Slice(_promo_IncreasePayment_Item_Gold,0,8)" Value2="Bag_Coins" /> <Equal Not="1" Value1="?Slice(_promo_IncreasePayment_Item_Gold,0,10)" Value2="Chest_Coins" /> <Equal Not="1" Value1="?Slice(_promo_IncreasePayment_Item_Gold,0,12)" Value2="Greater_Coins" /> </Conditions> <Actions> <SetVariable Name="promo_IncreasePayment_Item_Gold" Value="?Concat(Bag,?Slice(_$Purchase,4,25))" /> </Actions> </Quest> <Quest Name="FindNextGradePaidItem_Bag_Coins" Unresumable="1"> <Events> <Purchase /> </Events> <Conditions> <Equal Value1="?Slice(_$Purchase,0,8)" Value2="Bag_Coins" /> <Equal Not="1" Value1="?Slice(_$Purchase,0,10)" Value2="Bag_Coins_P" /> <Equal Not="1" Value1="?Slice(_promo_IncreasePayment_Item_Gold,0,10)" Value2="Chest_Coins" /> <Equal Not="1" Value1="?Slice(_promo_IncreasePayment_Item_Gold,0,12)" Value2="Greater_Coins" /> </Conditions> <Actions> <SetVariable Name="promo_IncreasePayment_Item_Gold" Value="?Concat(Chest,?Slice(_$Purchase,3,25))" /> </Actions> </Quest> <Quest Name="FindNextGradePaidItem_Bag_Coins" Unresumable="1"> <Events> <Purchase /> </Events> <Conditions> <Equal Value1="?Slice(_$Purchase,0,10)" Value2="Bag_Coins_P" /> <Equal Not="1" Value1="?Slice(_promo_IncreasePayment_Item_Gold,0,12)" Value2="Greater_Coins" /> </Conditions> <Actions> <SetVariable Name="promo_IncreasePayment_Item_Gold" Value="?Concat(Greater,?Slice(_$Purchase,3,25))" /> </Actions> </Quest> <Quest Name="FindNextGradePaidItem_Chest_Coins" Unresumable="1"> <Events> <Purchase /> </Events> <Conditions> <Equal Value1="?Slice(_$Purchase,0,10)" Value2="Chest_Coins" /> <Equal Not="1" Value1="?Slice(_promo_IncreasePayment_Item_Gold,0,12)" Value2="Greater_Coins" /> </Conditions> <Actions> <SetVariable Name="promo_IncreasePayment_Item_Gold" Value="?Concat(Greater,?Slice(_$Purchase,5,25))" /> </Actions> </Quest> <Quest Name="promo_IncreasePayment_Bonus_Launch" Unresumable="1"> <Events> <Activate /> </Events> <Conditions> <Equal Value1="_$ActionID" Value2="IncreasePayment_Launch" /> <Equal Value1="?Item(_promo_PrePurchase).SubType" Value2="Bonus" /> </Conditions> <Actions> <SetVariable Name="promo_SalePurchase" Value="_promo_IncreasePayment_Item_Bonus" /> <ActivateTimer Name="Timer_IncreasePayment" Value="1800" /> <ShowMapButton Name="Button_IncreasePayment" Image="?Item(_promo_IncreasePayment_Item_Bonus).Image" Timer="Timer_IncreasePayment" /> <OpenShop Tab="Ruby" Item="_promo_IncreasePayment_Item_Bonus" /> <Activate ActionID="IncreasePayment_Offer" /> </Actions> </Quest> <Quest Name="promo_IncreasePayment_Gold_Launch" Unresumable="1"> <Events> <Activate /> </Events> <Conditions> <Equal Value1="_$ActionID" Value2="IncreasePayment_Launch" /> <Equal Value1="?Item(_promo_PrePurchase).SubType" Value2="Gold" /> </Conditions> <Actions> <SetVariable Name="promo_SalePurchase" Value="_promo_IncreasePayment_Item_Gold" /> <ActivateTimer Name="Timer_IncreasePayment" Value="1800" /><ShowMapButton Name="Button_IncreasePayment" Image="?Item(_promo_IncreasePayment_Item_Gold).Image" Timer="Timer_IncreasePayment" /> <OpenShop Tab="Ruby" Item="_promo_IncreasePayment_Item_Gold" /> <Activate ActionID="IncreasePayment_Offer" /> </Actions> </Quest> <Quest Name="promo_IncreasePayment_OnPress"> <Events> <MapButtonPress /> </Events> <Conditions> <Equal Value1="_$ButtonName" Value2="Button_IncreasePayment" /> </Conditions> <Actions> <Activate ActionID="IncreasePayment_Offer" /> </Actions> </Quest> <Quest Name="promo_IncreasePayment_OnRestart" Priority="10" Unresumable="1"> <Events> <Activate /> </Events> <Conditions> <Equal Value1="_$ActionID" Value2="PseudoSessionStart" /> <Greater Value1="?Timer(Timer_IncreasePayment).Value" Value2="0" /> </Conditions> <Actions> <Activate ActionID="IncreasePayment_Offer" /> </Actions> </Quest> <Quest Name="promo_IncreasePayment_Offer_Gold" Unresumable="1"> <Events> <Activate /> </Events> <Conditions> <Equal Value1="_$ActionID" Value2="IncreasePayment_Offer" /> <Equal Value1="?Item(_promo_PrePurchase).SubType" Value2="Gold" /> </Conditions> <Actions> <Discount Item="_promo_SalePurchase" NewAmount="?Multi(_promo_Multiplier,?Item(_promo_SalePurchase).RecieveGold)" Period="?Timer(Timer_IncreasePayment).Value" Toggle="1" /> <Dialog Type="Multiline" Title="dlgSpecialOfferTitle" Image="?Item(_promo_SalePurchase).Image"> <Line Text="dlgRepeatPaymentOffer_Gold{?Concat(%,_promo_SalePurchase)}"> <Timer Name="Timer_IncreasePayment" /> </Line> <PriceLine Text="dlgProfitablePrice{?Concat(textures/misc/,?Player().CoinIcon)}{?Multi(_promo_Multiplier,?Item(_promo_SalePurchase).RecieveGold)}{?Item(_promo_SalePurchase).RealPrice}" TextColor="0xfefe95" /> <Button Type="Right" Color="Green" Text="dlgBuyButton"> <BuyItem Name="_promo_SalePurchase" Currency="Real" /> </Button> <Button Type="Left" Color="Red" Text="dlgLaterBtn" /> </Dialog> </Actions> </Quest> <Quest Name="promo_IncreasePayment_Offer_Ruby" Unresumable="1"> <Events> <Activate /> </Events> <Conditions> <Equal Value1="_$ActionID" Value2="IncreasePayment_Offer" /> <Equal Value1="?Item(_promo_PrePurchase).SubType" Value2="Bonus" /> </Conditions> <Actions> <Discount Item="_promo_SalePurchase" NewAmount="?Multi(_promo_Multiplier,?Item(_promo_SalePurchase).RecieveBonus)" Period="?Timer(Timer_IncreasePayment).Value" Toggle="1" /> <Dialog Type="Multiline" Title="dlgSpecialOfferTitle" Image="?Item(_promo_SalePurchase).Image"> <Line Text="dlgRepeatPaymentOffer_Ruby{?Concat(%,_promo_SalePurchase)}"> <Timer Name="Timer_IncreasePayment" /> </Line> <PriceLine Text="dlgProfitablePrice{?Concat(textures/misc/ruby.png)}{?Multi(_promo_Multiplier,?Item(_promo_SalePurchase).RecieveBonus)}{?Item(_promo_SalePurchase).RealPrice}" TextColor="0xfefe95" /> <Button Type="Right" Color="Green" Text="dlgBuyButton"> <BuyItem Name="_promo_SalePurchase" Currency="Real" /> </Button> <Button Type="Left" Color="Red" Text="dlgLaterBtn" /> </Dialog> </Actions> </Quest> <Quest Name="promo_IncreasePayment_Bought" Priority="5"> <Events> <Purchase /> </Events> <Conditions> <Greater Value1="?Timer(Timer_IncreasePayment).Value" Value2="0" /> <Equal Value1="_$Purchase" Value2="_promo_SalePurchase" /> </Conditions> <Actions> <Discount Item="_promo_SalePurchase" Toggle="0" /> <EndTimer Name="Timer_IncreasePayment"/> <HideMapButton Name="Button_IncreasePayment"/> </Actions> </Quest> <Quest Name="promo_IncreasePayment_Dismiss"> <Events> <TimerEnd /> </Events> <Conditions> <Equal Value1="_$TimerName" Value2="Timer_IncreasePayment" /> </Conditions> <Actions> <Discount Item="_promo_SalePurchase" Toggle="0" /> <HideMapButton Name="Button_IncreasePayment"/> </Actions> </Quest></Quests>